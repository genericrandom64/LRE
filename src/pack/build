#!/bin/bash

set -e

CLANGFLAGS="-std=c++98 -I../../include -Wno-writable-strings"

# Build the standalone lgnpack binary
clang -std=c++98 -g3  \
		main.cpp *.cc -o lgnpack $CLANGFLAGS

ln -srvf lgnpack ../../exec

# Generate the lib
clang -S -emit-llvm $CLANGFLAGS *.cc

FILES=$(find -name '*.ll')

llvm-link -v $FILES -o lgnpack.bc 
rm $FILES
mv -v lgnpack.bc ../../bin
